# Scrapy的安装

Scrapy是一个十分强大的爬虫框架，依赖的库比较多，至少需要依赖库有Twisted 14.0，lxml 3.4，pyOpenSSL 0.14。而在不同平台环境又各不相同，所以在安装之前最好确保把一些基本库安装好，尤其是Windows。

本节介绍一下Scrapy在不同平台的安装方法。

## Anaconda

这种方法是一种比较简单的安装Scrapy的方法（尤其是对Windows来说），你可以使用该方法安装，简单省力，也可以继续查看下文中直接在Python中的安装方法。

Anaconda是包含了常用的数据科学库的Python发行版本，实际上是一个集成Python环境，安装了它相当于你又装了一个Python环境，可以到[https://www.continuum.io/downloads](https://www.continuum.io/downloads)下载对应平台的包安装。

如果已经安装，那么可以轻松地通过`conda`命令安装Scrapy。

安装命令如下：

```
conda install Scrapy
```

## Windows

如果不想使用Anaconda安装，可以参考如下方式来一步步完成Scrapy的安装。

### 安装lxml

lxml的安装过程请参见前文lxml安装方法讲解，在此不再赘述。

### 安装pyOpenSSL

官方网站下载wheel文件，[https://pypi.python.org/pypi/pyOpenSSL#downloads](https://pypi.python.org/pypi/pyOpenSSL#downloads)，如当前最新版本名称是pyOpenSSL-16.2.0-py2.py3-none-any.whl。

下载后利用Pip安装即可：

```
pip3 install pyOpenSSL-16.2.0-py2.py3-none-any.whl 
```

### 安装Twisted

到[http://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted](http://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted)下载wheel文件，利用Pip安装即可。
如Python 3.6版本，Windows 64位系统，下载 Twisted‑17.1.0‑cp36‑cp36m‑win_amd64.whl。

然后Pip安装即可：

```
pip3 install Twisted‑17.1.0‑cp36‑cp36m‑win_amd64.whl
```

### 安装PyWin32

从官方网站 [https://sourceforge.net/projects/pywin32/files/pywin32/Build%20220/](https://sourceforge.net/projects/pywin32/files/pywin32/Build%20220/) 下载对应版本的安装包安装即可。

### 安装Scrapy

安装好了以上的依赖库，最后安装Scrapy就非常简单了，依然使用Pip，命令如下：

```
pip3 install Scrapy
```

等待命令结束没有报错，就证明Scrapy已经安装好了。

## Linux

在Linux上的安装方式依然分为两类平台介绍。

### CentOS、RedHat

首先确保一些依赖库已经安装，运行如下命令：

```
sudo yum groupinstall -y development tools
sudo yum install -y epel-release libxslt-devel libxml2-devel openssl-devel
```

最后利用Pip安装Scrapy即可，运行如下命令：

```
pip3 install Scrapy
```

### Ubuntu、Debian、Deepin

首先确保一些依赖库已经安装，运行如下命令：

```
sudo apt-get install build-essential python3-dev libssl-dev libffi-dev libxml2 libxml2-dev libxslt1-dev zlib1g-dev
```

然后利用Pip安装Scrapy即可，运行如下命令：

```
pip3 install Scrapy
```

## Mac OS

首先也是进行依赖库的安装。

在Mac上构建Scrapy的依赖库需要C编译器以及开发头文件，它一般由Xcode提供，运行如下命令安装即可：

```
xcode-select --install
```

随后利用Pip安装Scrapy即可，运行如下命令：

```
pip3 install Scrapy
```

## 验证

安装之后，在命令行下输入`scrapy`，如果出现类似下方的结果，就证明Scrapy安装成功。

![](./assets/2017-02-17-21-56-28.jpg)

## 常见错误

### pkg_resources.VersionConflict: (six 1.5.2 (/usr/lib/python3/dist-packages), Requirement.parse('six>=1.6.0'))

six包版本过低，six包是一个提供兼容Python2和Python3的库，升级six包即可。

```
sudo pip3 install -U six
```

### c/_cffi_backend.c:15:17: fatal error: ffi.h: No such file or directory

缺少Libffi这个库。什么是libffi？“FFI” 的全名是 Foreign Function Interface，通常指的是允许以一种语言编写的代码调用另一种语言的代码。而Libffi库只提供了最底层的、与架构相关的、完整的”FFI”。

安装相应的库即可。

Ubuntu、Debian：

```
sudo apt-get install build-essential libssl-dev libffi-dev python3-dev
```

CentOS、RedHat:

```
sudo yum install gcc libffi-devel python-devel openssl-devel
```

### ImportError: No module named 'cryptography'

这是缺少加密的相关组件，利用pip安装即可。

```
pip3 install cryptography
```
### ImportError: No module named 'packaging'

缺少packaging这个包，它提供了Python包的核心功能，利用pip安装即可。

```
pip3 install packaging
```
### ImportError: No module named 'appdirs'

缺少appdirs这个包，它用来确定文件目录，利用pip单独安装即可。

```
pip3 install appdirs
```
